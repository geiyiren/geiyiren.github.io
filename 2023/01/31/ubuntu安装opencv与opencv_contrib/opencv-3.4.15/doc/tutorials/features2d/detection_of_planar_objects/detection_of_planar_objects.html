<h1 id="Detection-of-planar-objects-tutorial-detection-of-planar-objects"><a href="#Detection-of-planar-objects-tutorial-detection-of-planar-objects" class="headerlink" title="Detection of planar objects {#tutorial_detection_of_planar_objects}"></a>Detection of planar objects {#tutorial_detection_of_planar_objects}</h1><p>@prev_tutorial{tutorial_feature_homography}<br>@next_tutorial{tutorial_akaze_matching}</p>
<p>The goal of this tutorial is to learn how to use <em>features2d</em> and <em>calib3d</em> modules for detecting<br>known planar objects in scenes.</p>
<p><em>Test data</em>: use images in your data folder, for instance, box.png and box_in_scene.png.</p>
<ul>
<li><p>Create a new console project. Read two input images. :</p>
<pre><code>Mat img1 = imread(argv[1], IMREAD_GRAYSCALE);
Mat img2 = imread(argv[2], IMREAD_GRAYSCALE);
</code></pre>
</li>
<li><p>Detect keypoints in both images and compute descriptors for each of the keypoints. :</p>
<pre><code>// detecting keypoints
Ptr&lt;Feature2D&gt; surf = SURF::create();
vector&lt;KeyPoint&gt; keypoints1;
Mat descriptors1;
surf-&gt;detectAndCompute(img1, Mat(), keypoints1, descriptors1);

... // do the same for the second image
</code></pre>
</li>
<li><p>Now, find the closest matches between descriptors from the first image to the second: :</p>
<pre><code>// matching descriptors
BruteForceMatcher&lt;L2&lt;float&gt; &gt; matcher;
vector&lt;DMatch&gt; matches;
matcher.match(descriptors1, descriptors2, matches);
</code></pre>
</li>
<li><p>Visualize the results: :</p>
<pre><code>// drawing the results
namedWindow(&quot;matches&quot;, 1);
Mat img_matches;
drawMatches(img1, keypoints1, img2, keypoints2, matches, img_matches);
imshow(&quot;matches&quot;, img_matches);
waitKey(0);
</code></pre>
</li>
<li><p>Find the homography transformation between two sets of points: :</p>
<pre><code>vector&lt;Point2f&gt; points1, points2;
// fill the arrays with the points
....
Mat H = findHomography(Mat(points1), Mat(points2), RANSAC, ransacReprojThreshold);
</code></pre>
</li>
<li><p>Create a set of inlier matches and draw them. Use perspectiveTransform function to map points<br>with homography:</p>
<p>Mat points1Projected; perspectiveTransform(Mat(points1), points1Projected, H);</p>
</li>
<li><p>Use drawMatches for drawing inliers.</p>
</li>
</ul>
