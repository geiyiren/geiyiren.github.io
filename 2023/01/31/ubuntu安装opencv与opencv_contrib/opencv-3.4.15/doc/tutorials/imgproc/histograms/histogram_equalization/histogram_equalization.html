<h1 id="Histogram-Equalization-tutorial-histogram-equalization"><a href="#Histogram-Equalization-tutorial-histogram-equalization" class="headerlink" title="Histogram Equalization {#tutorial_histogram_equalization}"></a>Histogram Equalization {#tutorial_histogram_equalization}</h1><p>@prev_tutorial{tutorial_warp_affine}<br>@next_tutorial{tutorial_histogram_calculation}</p>
<h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>In this tutorial you will learn:</p>
<ul>
<li>What an image histogram is and why it is useful</li>
<li>To equalize histograms of images by using the OpenCV function @ref cv::equalizeHist</li>
</ul>
<h2 id="Theory"><a href="#Theory" class="headerlink" title="Theory"></a>Theory</h2><h3 id="What-is-an-Image-Histogram"><a href="#What-is-an-Image-Histogram" class="headerlink" title="What is an Image Histogram?"></a>What is an Image Histogram?</h3><ul>
<li>It is a graphical representation of the intensity distribution of an image.</li>
<li>It quantifies the number of pixels for each intensity value considered.</li>
</ul>
<p><img src="/images/Histogram_Equalization_Theory_0.jpg"></p>
<h3 id="What-is-Histogram-Equalization"><a href="#What-is-Histogram-Equalization" class="headerlink" title="What is Histogram Equalization?"></a>What is Histogram Equalization?</h3><ul>
<li>It is a method that improves the contrast in an image, in order to stretch out the intensity<br>range (see also the corresponding <a href="https://en.wikipedia.org/wiki/Histogram_equalization">Wikipedia entry</a>).</li>
<li>To make it clearer, from the image above, you can see that the pixels seem clustered around the<br>middle of the available range of intensities. What Histogram Equalization does is to <em>stretch<br>out</em> this range. Take a look at the figure below: The green circles indicate the<br><em>underpopulated</em> intensities. After applying the equalization, we get an histogram like the<br>figure in the center. The resulting image is shown in the picture at right.</li>
</ul>
<p><img src="/images/Histogram_Equalization_Theory_1.jpg"></p>
<h3 id="How-does-it-work"><a href="#How-does-it-work" class="headerlink" title="How does it work?"></a>How does it work?</h3><ul>
<li><p>Equalization implies <em>mapping</em> one distribution (the given histogram) to another distribution (a<br>wider and more uniform distribution of intensity values) so the intensity values are spread<br>over the whole range.</p>
</li>
<li><p>To accomplish the equalization effect, the remapping should be the <em>cumulative distribution<br>function (cdf)</em> (more details, refer to <em>Learning OpenCV</em>). For the histogram \f$H(i)\f$, its<br><em>cumulative distribution</em> \f$H^{‘}(i)\f$ is:</p>
<p>\f[H^{‘}(i) &#x3D; \sum_{0 \le j &lt; i} H(j)\f]</p>
<p>To use this as a remapping function, we have to normalize \f$H^{‘}(i)\f$ such that the maximum value<br>is 255 ( or the maximum value for the intensity of the image ). From the example above, the<br>cumulative function is:</p>
<p><img src="/images/Histogram_Equalization_Theory_2.jpg"></p>
</li>
<li><p>Finally, we use a simple remapping procedure to obtain the intensity values of the equalized<br>image:</p>
<p>\f[equalized( x, y ) &#x3D; H^{‘}( src(x,y) )\f]</p>
</li>
</ul>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><ul>
<li><strong>What does this program do?</strong><ul>
<li>Loads an image</li>
<li>Convert the original image to grayscale</li>
<li>Equalize the Histogram by using the OpenCV function @ref cv::equalizeHist</li>
<li>Display the source and equalized images in a window.</li>
</ul>
</li>
</ul>
<p>@add_toggle_cpp</p>
<ul>
<li><p><strong>Downloadable code</strong>: Click<br><a href="https://github.com/opencv/opencv/tree/3.4/samples/cpp/tutorial_code/Histograms_Matching/EqualizeHist_Demo.cpp">here</a></p>
</li>
<li><p><strong>Code at glance:</strong><br>@include samples&#x2F;cpp&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;EqualizeHist_Demo.cpp<br>@end_toggle</p>
</li>
</ul>
<p>@add_toggle_java</p>
<ul>
<li><p><strong>Downloadable code</strong>: Click<br><a href="https://github.com/opencv/opencv/tree/3.4/samples/java/tutorial_code/Histograms_Matching/histogram_equalization/EqualizeHistDemo.java">here</a></p>
</li>
<li><p><strong>Code at glance:</strong><br>@include samples&#x2F;java&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHistDemo.java<br>@end_toggle</p>
</li>
</ul>
<p>@add_toggle_python</p>
<ul>
<li><p><strong>Downloadable code</strong>: Click<br><a href="https://github.com/opencv/opencv/tree/3.4/samples/python/tutorial_code/Histograms_Matching/histogram_equalization/EqualizeHist_Demo.py">here</a></p>
</li>
<li><p><strong>Code at glance:</strong><br>@include samples&#x2F;python&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHist_Demo.py<br>@end_toggle</p>
</li>
</ul>
<h2 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a>Explanation</h2><ul>
<li><p>Load the source image:</p>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;EqualizeHist_Demo.cpp Load image<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHistDemo.java Load image<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHist_Demo.py Load image<br>@end_toggle</p>
</li>
<li><p>Convert it to grayscale:</p>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;EqualizeHist_Demo.cpp Convert to grayscale<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHistDemo.java Convert to grayscale<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHist_Demo.py Convert to grayscale<br>@end_toggle</p>
</li>
<li><p>Apply histogram equalization with the function @ref cv::equalizeHist :</p>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;EqualizeHist_Demo.cpp Apply Histogram Equalization<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHistDemo.java Apply Histogram Equalization<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHist_Demo.py Apply Histogram Equalization<br>@end_toggle<br>As it can be easily seen, the only arguments are the original image and the output (equalized)<br>image.</p>
</li>
<li><p>Display both images (original and equalized):</p>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;EqualizeHist_Demo.cpp Display results<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHistDemo.java Display results<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHist_Demo.py Display results<br>@end_toggle</p>
</li>
<li><p>Wait until user exists the program</p>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;EqualizeHist_Demo.cpp Wait until user exits the program<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHistDemo.java Wait until user exits the program<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;Histograms_Matching&#x2F;histogram_equalization&#x2F;EqualizeHist_Demo.py Wait until user exits the program<br>@end_toggle</p>
</li>
</ul>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>-#  To appreciate better the results of equalization, let’s introduce an image with not much<br>    contrast, such as:</p>
<pre><code>![](images/Histogram_Equalization_Original_Image.jpg)

which, by the way, has this histogram:

![](images/Histogram_Equalization_Original_Histogram.jpg)

notice that the pixels are clustered around the center of the histogram.
</code></pre>
<p>-#  After applying the equalization with our program, we get this result:</p>
<pre><code>![](images/Histogram_Equalization_Equalized_Image.jpg)

this image has certainly more contrast. Check out its new histogram like this:

![](images/Histogram_Equalization_Equalized_Histogram.jpg)

Notice how the number of pixels is more distributed through the intensity range.
</code></pre>
<p>@note<br>Are you wondering how did we draw the Histogram figures shown above? Check out the following<br>tutorial!</p>
