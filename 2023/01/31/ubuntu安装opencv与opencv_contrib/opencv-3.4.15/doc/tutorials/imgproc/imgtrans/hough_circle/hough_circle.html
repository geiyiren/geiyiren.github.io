<h1 id="Hough-Circle-Transform-tutorial-hough-circle"><a href="#Hough-Circle-Transform-tutorial-hough-circle" class="headerlink" title="Hough Circle Transform {#tutorial_hough_circle}"></a>Hough Circle Transform {#tutorial_hough_circle}</h1><p>@prev_tutorial{tutorial_hough_lines}<br>@next_tutorial{tutorial_remap}</p>
<h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>In this tutorial you will learn how to:</p>
<ul>
<li>Use the OpenCV function <strong>HoughCircles()</strong> to detect circles in an image.</li>
</ul>
<h2 id="Theory"><a href="#Theory" class="headerlink" title="Theory"></a>Theory</h2><h3 id="Hough-Circle-Transform"><a href="#Hough-Circle-Transform" class="headerlink" title="Hough Circle Transform"></a>Hough Circle Transform</h3><ul>
<li><p>The Hough Circle Transform works in a <em>roughly</em> analogous way to the Hough Line Transform<br>explained in the previous tutorial.</p>
</li>
<li><p>In the line detection case, a line was defined by two parameters \f$(r, \theta)\f$. In the circle<br>case, we need three parameters to define a circle:</p>
<p>\f[C : ( x_{center}, y_{center}, r )\f]</p>
<p>where \f$(x_{center}, y_{center})\f$ define the center position (green point) and \f$r\f$ is the radius,<br>which allows us to completely define a circle, as it can be seen below:</p>
<p><img src="/images/Hough_Circle_Tutorial_Theory_0.jpg"></p>
</li>
<li><p>For sake of efficiency, OpenCV implements a detection method slightly trickier than the standard<br>Hough Transform: <em>The Hough gradient method</em>, which is made up of two main stages. The first<br>stage involves edge detection and finding the possible circle centers and the second stage finds<br>the best radius for each candidate center. For more details, please check the book <em>Learning<br>OpenCV</em> or your favorite Computer Vision bibliography</p>
</li>
</ul>
<h4 id="What-does-this-program-do"><a href="#What-does-this-program-do" class="headerlink" title="What does this program do?"></a>What does this program do?</h4><ul>
<li>Loads an image and blur it to reduce the noise</li>
<li>Applies the <em>Hough Circle Transform</em> to the blurred image .</li>
<li>Display the detected circle in a window.</li>
</ul>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>@add_toggle_cpp<br>The sample code that we will explain can be downloaded from<br><a href="https://raw.githubusercontent.com/opencv/opencv/3.4/samples/cpp/tutorial_code/ImgTrans/houghcircles.cpp">here</a>.<br>A slightly fancier version (which shows trackbars for changing the threshold values) can be found<br><a href="https://raw.githubusercontent.com/opencv/opencv/3.4/samples/cpp/tutorial_code/ImgTrans/HoughCircle_Demo.cpp">here</a>.<br>@include samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghcircles.cpp<br>@end_toggle</p>
<p>@add_toggle_java<br>The sample code that we will explain can be downloaded from<br><a href="https://raw.githubusercontent.com/opencv/opencv/3.4/samples/java/tutorial_code/ImgTrans/HoughCircle/HoughCircles.java">here</a>.<br>@include samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;HoughCircles.java<br>@end_toggle</p>
<p>@add_toggle_python<br>The sample code that we will explain can be downloaded from<br><a href="https://raw.githubusercontent.com/opencv/opencv/3.4/samples/python/tutorial_code/ImgTrans/HoughCircle/hough_circle.py">here</a>.<br>@include samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;hough_circle.py<br>@end_toggle</p>
<h2 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a>Explanation</h2><p>The image we used can be found <a href="https://raw.githubusercontent.com/opencv/opencv/3.4/samples/data/smarties.png">here</a></p>
<h4 id="Load-an-image"><a href="#Load-an-image" class="headerlink" title="Load an image:"></a>Load an image:</h4><p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghcircles.cpp load<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;hough_circle.py load<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;HoughCircles.java load<br>@end_toggle</p>
<h4 id="Convert-it-to-grayscale"><a href="#Convert-it-to-grayscale" class="headerlink" title="Convert it to grayscale:"></a>Convert it to grayscale:</h4><p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghcircles.cpp convert_to_gray<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;hough_circle.py convert_to_gray<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;HoughCircles.java convert_to_gray<br>@end_toggle</p>
<h4 id="Apply-a-Median-blur-to-reduce-noise-and-avoid-false-circle-detection"><a href="#Apply-a-Median-blur-to-reduce-noise-and-avoid-false-circle-detection" class="headerlink" title="Apply a Median blur to reduce noise and avoid false circle detection:"></a>Apply a Median blur to reduce noise and avoid false circle detection:</h4><p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghcircles.cpp reduce_noise<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;hough_circle.py reduce_noise<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;HoughCircles.java reduce_noise<br>@end_toggle</p>
<h4 id="Proceed-to-apply-Hough-Circle-Transform"><a href="#Proceed-to-apply-Hough-Circle-Transform" class="headerlink" title="Proceed to apply Hough Circle Transform:"></a>Proceed to apply Hough Circle Transform:</h4><p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghcircles.cpp houghcircles<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;hough_circle.py houghcircles<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;HoughCircles.java houghcircles<br>@end_toggle</p>
<ul>
<li><p>with the arguments:</p>
<ul>
<li><em>gray</em>: Input image (grayscale).</li>
<li><em>circles</em>: A vector that stores sets of 3 values: \f$x_{c}, y_{c}, r\f$ for each detected<br>circle.</li>
<li><em>HOUGH_GRADIENT</em>: Define the detection method. Currently this is the only one available in<br>OpenCV.</li>
<li><em>dp &#x3D; 1</em>: The inverse ratio of resolution.</li>
<li><em>min_dist &#x3D; gray.rows&#x2F;16</em>: Minimum distance between detected centers.</li>
<li><em>param_1 &#x3D; 200</em>: Upper threshold for the internal Canny edge detector.</li>
<li><em>param_2</em> &#x3D; 100*: Threshold for center detection.</li>
<li><em>min_radius &#x3D; 0</em>: Minimum radius to be detected. If unknown, put zero as default.</li>
<li><em>max_radius &#x3D; 0</em>: Maximum radius to be detected. If unknown, put zero as default.</li>
</ul>
</li>
</ul>
<h4 id="Draw-the-detected-circles"><a href="#Draw-the-detected-circles" class="headerlink" title="Draw the detected circles:"></a>Draw the detected circles:</h4><p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghcircles.cpp draw<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;hough_circle.py draw<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;HoughCircles.java draw<br>@end_toggle</p>
<p>You can see that we will draw the circle(s) on red and the center(s) with a small green dot</p>
<h4 id="Display-the-detected-circle-s-and-wait-for-the-user-to-exit-the-program"><a href="#Display-the-detected-circle-s-and-wait-for-the-user-to-exit-the-program" class="headerlink" title="Display the detected circle(s) and wait for the user to exit the program:"></a>Display the detected circle(s) and wait for the user to exit the program:</h4><p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghcircles.cpp display<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;hough_circle.py display<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughCircle&#x2F;HoughCircles.java display<br>@end_toggle</p>
<h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><p>The result of running the code above with a test image is shown below:</p>
<p><img src="/images/Hough_Circle_Tutorial_Result.png"></p>
