<h1 id="Hough-Line-Transform-tutorial-hough-lines"><a href="#Hough-Line-Transform-tutorial-hough-lines" class="headerlink" title="Hough Line Transform {#tutorial_hough_lines}"></a>Hough Line Transform {#tutorial_hough_lines}</h1><p>@prev_tutorial{tutorial_canny_detector}<br>@next_tutorial{tutorial_hough_circle}</p>
<h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>In this tutorial you will learn how to:</p>
<ul>
<li>Use the OpenCV functions <strong>HoughLines()</strong> and <strong>HoughLinesP()</strong> to detect lines in an<br>image.</li>
</ul>
<h2 id="Theory"><a href="#Theory" class="headerlink" title="Theory"></a>Theory</h2><p>@note The explanation below belongs to the book <strong>Learning OpenCV</strong> by Bradski and Kaehler.</p>
<h2 id="Hough-Line-Transform"><a href="#Hough-Line-Transform" class="headerlink" title="Hough Line Transform"></a>Hough Line Transform</h2><p>-# The Hough Line Transform is a transform used to detect straight lines.<br>-# To apply the Transform, first an edge detection pre-processing is desirable.</p>
<h3 id="How-does-it-work"><a href="#How-does-it-work" class="headerlink" title="How does it work?"></a>How does it work?</h3><p>-#  As you know, a line in the image space can be expressed with two variables. For example:</p>
<pre><code>-#  In the **Cartesian coordinate system:** Parameters: \f$(m,b)\f$.
-#  In the **Polar coordinate system:** Parameters: \f$(r,\theta)\f$

![](images/Hough_Lines_Tutorial_Theory_0.jpg)

For Hough Transforms, we will express lines in the *Polar system*. Hence, a line equation can be
written as:

\f[y = \left ( -\dfrac{\cos \theta}{\sin \theta} \right ) x + \left ( \dfrac{r}{\sin \theta} \right )\f]
</code></pre>
<p>Arranging the terms: \f$r &#x3D; x \cos \theta + y \sin \theta\f$</p>
<p>-#  In general for each point \f$(x_{0}, y_{0})\f$, we can define the family of lines that goes through<br>    that point as:</p>
<pre><code>\f[r_{\theta} = x_{0} \cdot \cos \theta  + y_{0} \cdot \sin \theta\f]

Meaning that each pair \f$(r_{\theta},\theta)\f$ represents each line that passes by
\f$(x_{0}, y_{0})\f$.
</code></pre>
<p>-#  If for a given \f$(x_{0}, y_{0})\f$ we plot the family of lines that goes through it, we get a<br>    sinusoid. For instance, for \f$x_{0} &#x3D; 8\f$ and \f$y_{0} &#x3D; 6\f$ we get the following plot (in a plane<br>    \f$\theta\f$ - \f$r\f$):</p>
<pre><code>![](images/Hough_Lines_Tutorial_Theory_1.jpg)

We consider only points such that \f$r &gt; 0\f$ and \f$0&lt; \theta &lt; 2 \pi\f$.
</code></pre>
<p>-#  We can do the same operation above for all the points in an image. If the curves of two<br>    different points intersect in the plane \f$\theta\f$ - \f$r\f$, that means that both points belong to a<br>    same line. For instance, following with the example above and drawing the plot for two more<br>    points: \f$x_{1} &#x3D; 4\f$, \f$y_{1} &#x3D; 9\f$ and \f$x_{2} &#x3D; 12\f$, \f$y_{2} &#x3D; 3\f$, we get:</p>
<pre><code>![](images/Hough_Lines_Tutorial_Theory_2.jpg)

The three plots intersect in one single point \f$(0.925, 9.6)\f$, these coordinates are the
parameters (\f$\theta, r\f$) or the line in which \f$(x_{0}, y_{0})\f$, \f$(x_{1}, y_{1})\f$ and
\f$(x_{2}, y_{2})\f$ lay.
</code></pre>
<p>-#  What does all the stuff above mean? It means that in general, a line can be <em>detected</em> by<br>    finding the number of intersections between curves.The more curves intersecting means that the<br>    line represented by that intersection have more points. In general, we can define a <em>threshold</em><br>    of the minimum number of intersections needed to <em>detect</em> a line.<br>-#  This is what the Hough Line Transform does. It keeps track of the intersection between curves of<br>    every point in the image. If the number of intersections is above some <em>threshold</em>, then it<br>    declares it as a line with the parameters \f$(\theta, r_{\theta})\f$ of the intersection point.</p>
<h3 id="Standard-and-Probabilistic-Hough-Line-Transform"><a href="#Standard-and-Probabilistic-Hough-Line-Transform" class="headerlink" title="Standard and Probabilistic Hough Line Transform"></a>Standard and Probabilistic Hough Line Transform</h3><p>OpenCV implements two kind of Hough Line Transforms:</p>
<p>a.  <strong>The Standard Hough Transform</strong></p>
<ul>
<li>It consists in pretty much what we just explained in the previous section. It gives you as<br>result a vector of couples \f$(\theta, r_{\theta})\f$</li>
<li>In OpenCV it is implemented with the function <strong>HoughLines()</strong></li>
</ul>
<p>b.  <strong>The Probabilistic Hough Line Transform</strong></p>
<ul>
<li>A more efficient implementation of the Hough Line Transform. It gives as output the extremes<br>of the detected lines \f$(x_{0}, y_{0}, x_{1}, y_{1})\f$</li>
<li>In OpenCV it is implemented with the function <strong>HoughLinesP()</strong></li>
</ul>
<h3 id="What-does-this-program-do"><a href="#What-does-this-program-do" class="headerlink" title="What does this program do?"></a>What does this program do?</h3><pre><code>-   Loads an image
-   Applies a *Standard Hough Line Transform* and a *Probabilistic Line Transform*.
-   Display the original image and the detected line in three windows.
</code></pre>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>@add_toggle_cpp<br>The sample code that we will explain can be downloaded from<br><a href="https://raw.githubusercontent.com/opencv/opencv/3.4/samples/cpp/tutorial_code/ImgTrans/houghlines.cpp">here</a>.<br>A slightly fancier version (which shows both Hough standard and probabilistic<br>with trackbars for changing the threshold values) can be found<br><a href="https://raw.githubusercontent.com/opencv/opencv/3.4/samples/cpp/tutorial_code/ImgTrans/HoughLines_Demo.cpp">here</a>.<br>@include samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghlines.cpp<br>@end_toggle</p>
<p>@add_toggle_java<br>The sample code that we will explain can be downloaded from<br><a href="https://raw.githubusercontent.com/opencv/opencv/3.4/samples/java/tutorial_code/ImgTrans/HoughLine/HoughLines.java">here</a>.<br>@include samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;HoughLines.java<br>@end_toggle</p>
<p>@add_toggle_python<br>The sample code that we will explain can be downloaded from<br><a href="https://raw.githubusercontent.com/opencv/opencv/3.4/samples/python/tutorial_code/ImgTrans/HoughLine/hough_lines.py">here</a>.<br>@include samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;hough_lines.py<br>@end_toggle</p>
<h2 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a>Explanation</h2><h4 id="Load-an-image"><a href="#Load-an-image" class="headerlink" title="Load an image:"></a>Load an image:</h4><p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghlines.cpp load<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;HoughLines.java load<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;hough_lines.py load<br>@end_toggle</p>
<h4 id="Detect-the-edges-of-the-image-by-using-a-Canny-detector"><a href="#Detect-the-edges-of-the-image-by-using-a-Canny-detector" class="headerlink" title="Detect the edges of the image by using a Canny detector:"></a>Detect the edges of the image by using a Canny detector:</h4><p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghlines.cpp edge_detection<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;HoughLines.java edge_detection<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;hough_lines.py edge_detection<br>@end_toggle</p>
<p>Now we will apply the Hough Line Transform. We will explain how to use both OpenCV functions<br>available for this purpose.</p>
<h4 id="Standard-Hough-Line-Transform"><a href="#Standard-Hough-Line-Transform" class="headerlink" title="Standard Hough Line Transform:"></a>Standard Hough Line Transform:</h4><p>First, you apply the Transform:</p>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghlines.cpp hough_lines<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;HoughLines.java hough_lines<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;hough_lines.py hough_lines<br>@end_toggle</p>
<ul>
<li><pre><code>  with the following arguments:

  -   *dst*: Output of the edge detector. It should be a grayscale image (although in fact it
      is a binary one)
  -   *lines*: A vector that will store the parameters \f$(r,\theta)\f$ of the detected lines
  -   *rho* : The resolution of the parameter \f$r\f$ in pixels. We use **1** pixel.
  -   *theta*: The resolution of the parameter \f$\theta\f$ in radians. We use **1 degree**
      (CV_PI/180)
  -   *threshold*: The minimum number of intersections to &quot;*detect*&quot; a line
  -   *srn* and *stn*: Default parameters to zero. Check OpenCV reference for more info.
</code></pre>
</li>
</ul>
<p>And then you display the result by drawing the lines.<br>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghlines.cpp draw_lines<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;HoughLines.java draw_lines<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;hough_lines.py draw_lines<br>@end_toggle</p>
<h4 id="Probabilistic-Hough-Line-Transform"><a href="#Probabilistic-Hough-Line-Transform" class="headerlink" title="Probabilistic Hough Line Transform"></a>Probabilistic Hough Line Transform</h4><p>First you apply the transform:</p>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghlines.cpp hough_lines_p<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;HoughLines.java hough_lines_p<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;hough_lines.py hough_lines_p<br>@end_toggle</p>
<ul>
<li><pre><code>  with the arguments:

  -   *dst*: Output of the edge detector. It should be a grayscale image (although in fact it
      is a binary one)
  -   *lines*: A vector that will store the parameters
      \f$(x_{start}, y_{start}, x_{end}, y_{end})\f$ of the detected lines
  -   *rho* : The resolution of the parameter \f$r\f$ in pixels. We use **1** pixel.
  -   *theta*: The resolution of the parameter \f$\theta\f$ in radians. We use **1 degree**
      (CV_PI/180)
  -   *threshold*: The minimum number of intersections to &quot;*detect*&quot; a line
  -   *minLineLength*: The minimum number of points that can form a line. Lines with less than
      this number of points are disregarded.
  -   *maxLineGap*: The maximum gap between two points to be considered in the same line.
</code></pre>
</li>
</ul>
<p>And then you display the result by drawing the lines.</p>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghlines.cpp draw_lines_p<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;HoughLines.java draw_lines_p<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;hough_lines.py draw_lines_p<br>@end_toggle</p>
<h4 id="Display-the-original-image-and-the-detected-lines"><a href="#Display-the-original-image-and-the-detected-lines" class="headerlink" title="Display the original image and the detected lines:"></a>Display the original image and the detected lines:</h4><p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghlines.cpp imshow<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;HoughLines.java imshow<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;hough_lines.py imshow<br>@end_toggle</p>
<h4 id="Wait-until-the-user-exits-the-program"><a href="#Wait-until-the-user-exits-the-program" class="headerlink" title="Wait until the user exits the program"></a>Wait until the user exits the program</h4><p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;houghlines.cpp exit<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;HoughLines.java exit<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;ImgTrans&#x2F;HoughLine&#x2F;hough_lines.py exit<br>@end_toggle</p>
<h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><p>@note<br>   The results below are obtained using the slightly fancier version we mentioned in the <em>Code</em><br>    section. It still implements the same stuff as above, only adding the Trackbar for the<br>    Threshold.</p>
<p>Using an input image such as a <a href="https://raw.githubusercontent.com/opencv/opencv/3.4/samples/data/sudoku.png">sudoku image</a>.<br>We get the following result by using the Standard Hough Line Transform:<br><img src="/images/hough_lines_result1.png"><br>And by using the Probabilistic Hough Line Transform:<br><img src="/images/hough_lines_result2.png"></p>
<p>You may observe that the number of lines detected vary while you change the <em>threshold</em>. The<br>explanation is sort of evident: If you establish a higher threshold, fewer lines will be detected<br>(since you will need more points to declare a line detected).</p>
