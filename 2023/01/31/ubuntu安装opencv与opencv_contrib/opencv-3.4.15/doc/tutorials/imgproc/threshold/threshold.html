<h1 id="Basic-Thresholding-Operations-tutorial-threshold"><a href="#Basic-Thresholding-Operations-tutorial-threshold" class="headerlink" title="Basic Thresholding Operations {#tutorial_threshold}"></a>Basic Thresholding Operations {#tutorial_threshold}</h1><p>@prev_tutorial{tutorial_pyramids}<br>@next_tutorial{tutorial_threshold_inRange}</p>
<h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>In this tutorial you will learn how to:</p>
<ul>
<li>Perform basic thresholding operations using OpenCV function @ref cv::threshold</li>
</ul>
<h2 id="Cool-Theory"><a href="#Cool-Theory" class="headerlink" title="Cool Theory"></a>Cool Theory</h2><p>@note The explanation below belongs to the book <strong>Learning OpenCV</strong> by Bradski and Kaehler. What is</p>
<h2 id="Thresholding"><a href="#Thresholding" class="headerlink" title="Thresholding?"></a>Thresholding?</h2><ul>
<li><p>The simplest segmentation method</p>
</li>
<li><p>Application example: Separate out regions of an image corresponding to objects which we want to<br>analyze. This separation is based on the variation of intensity between the object pixels and<br>the background pixels.</p>
</li>
<li><p>To differentiate the pixels we are interested in from the rest (which will eventually be<br>rejected), we perform a comparison of each pixel intensity value with respect to a <em>threshold</em><br>(determined according to the problem to solve).</p>
</li>
<li><p>Once we have separated properly the important pixels, we can set them with a determined value to<br>identify them (i.e. we can assign them a value of \f$0\f$ (black), \f$255\f$ (white) or any value that<br>suits your needs).</p>
<p><img src="/images/Threshold_Tutorial_Theory_Example.jpg"></p>
</li>
</ul>
<h3 id="Types-of-Thresholding"><a href="#Types-of-Thresholding" class="headerlink" title="Types of Thresholding"></a>Types of Thresholding</h3><ul>
<li><p>OpenCV offers the function @ref cv::threshold to perform thresholding operations.</p>
</li>
<li><p>We can effectuate \f$5\f$ types of Thresholding operations with this function. We will explain them<br>in the following subsections.</p>
</li>
<li><p>To illustrate how these thresholding processes work, let’s consider that we have a source image<br>with pixels with intensity values \f$src(x,y)\f$. The plot below depicts this. The horizontal blue<br>line represents the threshold \f$thresh\f$ (fixed).</p>
<p><img src="/images/Threshold_Tutorial_Theory_Base_Figure.png"></p>
</li>
</ul>
<h4 id="Threshold-Binary"><a href="#Threshold-Binary" class="headerlink" title="Threshold Binary"></a>Threshold Binary</h4><ul>
<li><p>This thresholding operation can be expressed as:</p>
<p>\f[\texttt{dst} (x,y) &#x3D;  \fork{\texttt{maxVal}}{if (\texttt{src}(x,y) &gt; \texttt{thresh})}{0}{otherwise}\f]</p>
</li>
<li><p>So, if the intensity of the pixel \f$src(x,y)\f$ is higher than \f$thresh\f$, then the new pixel<br>intensity is set to a \f$MaxVal\f$. Otherwise, the pixels are set to \f$0\f$.</p>
<p><img src="/images/Threshold_Tutorial_Theory_Binary.png"></p>
</li>
</ul>
<h4 id="Threshold-Binary-Inverted"><a href="#Threshold-Binary-Inverted" class="headerlink" title="Threshold Binary, Inverted"></a>Threshold Binary, Inverted</h4><ul>
<li><p>This thresholding operation can be expressed as:</p>
<p>\f[\texttt{dst} (x,y) &#x3D;  \fork{0}{if (\texttt{src}(x,y) &gt; \texttt{thresh})}{\texttt{maxVal}}{otherwise}\f]</p>
</li>
<li><p>If the intensity of the pixel \f$src(x,y)\f$ is higher than \f$thresh\f$, then the new pixel intensity<br>is set to a \f$0\f$. Otherwise, it is set to \f$MaxVal\f$.</p>
<p><img src="/images/Threshold_Tutorial_Theory_Binary_Inverted.png"></p>
</li>
</ul>
<h4 id="Truncate"><a href="#Truncate" class="headerlink" title="Truncate"></a>Truncate</h4><ul>
<li><p>This thresholding operation can be expressed as:</p>
<p>\f[\texttt{dst} (x,y) &#x3D;  \fork{\texttt{threshold}}{if (\texttt{src}(x,y) &gt; \texttt{thresh})}{\texttt{src}(x,y)}{otherwise}\f]</p>
</li>
<li><p>The maximum intensity value for the pixels is \f$thresh\f$, if \f$src(x,y)\f$ is greater, then its value<br>is <em>truncated</em>. See figure below:</p>
<p><img src="/images/Threshold_Tutorial_Theory_Truncate.png"></p>
</li>
</ul>
<h4 id="Threshold-to-Zero"><a href="#Threshold-to-Zero" class="headerlink" title="Threshold to Zero"></a>Threshold to Zero</h4><ul>
<li><p>This operation can be expressed as:</p>
<p>\f[\texttt{dst} (x,y) &#x3D;  \fork{\texttt{src}(x,y)}{if (\texttt{src}(x,y) &gt; \texttt{thresh})}{0}{otherwise}\f]</p>
</li>
<li><p>If \f$src(x,y)\f$ is lower than \f$thresh\f$, the new pixel value will be set to \f$0\f$.</p>
<p><img src="/images/Threshold_Tutorial_Theory_Zero.png"></p>
</li>
</ul>
<h4 id="Threshold-to-Zero-Inverted"><a href="#Threshold-to-Zero-Inverted" class="headerlink" title="Threshold to Zero, Inverted"></a>Threshold to Zero, Inverted</h4><ul>
<li><p>This operation can be expressed as:</p>
<p>\f[\texttt{dst} (x,y) &#x3D;  \fork{0}{if (\texttt{src}(x,y) &gt; \texttt{thresh})}{\texttt{src}(x,y)}{otherwise}\f]</p>
</li>
<li><p>If \f$src(x,y)\f$ is greater than \f$thresh\f$, the new pixel value will be set to \f$0\f$.</p>
<p><img src="/images/Threshold_Tutorial_Theory_Zero_Inverted.png"></p>
</li>
</ul>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>@add_toggle_cpp<br>The tutorial code’s is shown lines below. You can also download it from<br><a href="https://github.com/opencv/opencv/tree/3.4/samples/cpp/tutorial_code/ImgProc/Threshold.cpp">here</a><br>@include samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgProc&#x2F;Threshold.cpp<br>@end_toggle</p>
<p>@add_toggle_java<br>The tutorial code’s is shown lines below. You can also download it from<br><a href="https://github.com/opencv/opencv/tree/3.4/samples/java/tutorial_code/ImgProc/threshold/Threshold.java">here</a><br>@include samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgProc&#x2F;threshold&#x2F;Threshold.java<br>@end_toggle</p>
<p>@add_toggle_python<br>The tutorial code’s is shown lines below. You can also download it from<br><a href="https://github.com/opencv/opencv/tree/3.4/samples/python/tutorial_code/imgProc/threshold/threshold.py">here</a><br>@include samples&#x2F;python&#x2F;tutorial_code&#x2F;imgProc&#x2F;threshold&#x2F;threshold.py<br>@end_toggle</p>
<h2 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a>Explanation</h2><p>Let’s check the general structure of the program:</p>
<ul>
<li>Load an image. If it is BGR we convert it to Grayscale. For this, remember that we can use<br>the function @ref cv::cvtColor :</li>
</ul>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgProc&#x2F;Threshold.cpp load<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgProc&#x2F;threshold&#x2F;Threshold.java load<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;imgProc&#x2F;threshold&#x2F;threshold.py load<br>@end_toggle</p>
<ul>
<li>Create a window to display the result</li>
</ul>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgProc&#x2F;Threshold.cpp window<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgProc&#x2F;threshold&#x2F;Threshold.java window<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;imgProc&#x2F;threshold&#x2F;threshold.py window<br>@end_toggle</p>
<ul>
<li><p>Create \f$2\f$ trackbars for the user to enter user input:</p>
<ul>
<li><strong>Type of thresholding</strong>: Binary, To Zero, etc…</li>
<li><strong>Threshold value</strong></li>
</ul>
</li>
</ul>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgProc&#x2F;Threshold.cpp trackbar<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgProc&#x2F;threshold&#x2F;Threshold.java trackbar<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;imgProc&#x2F;threshold&#x2F;threshold.py trackbar<br>@end_toggle</p>
<ul>
<li>Wait until the user enters the threshold value, the type of thresholding (or until the<br>program exits)</li>
<li>Whenever the user changes the value of any of the Trackbars, the function <em>Threshold_Demo</em><br>(<em>update</em> in Java) is called:</li>
</ul>
<p>@add_toggle_cpp<br>@snippet samples&#x2F;cpp&#x2F;tutorial_code&#x2F;ImgProc&#x2F;Threshold.cpp Threshold_Demo<br>@end_toggle</p>
<p>@add_toggle_java<br>@snippet samples&#x2F;java&#x2F;tutorial_code&#x2F;ImgProc&#x2F;threshold&#x2F;Threshold.java Threshold_Demo<br>@end_toggle</p>
<p>@add_toggle_python<br>@snippet samples&#x2F;python&#x2F;tutorial_code&#x2F;imgProc&#x2F;threshold&#x2F;threshold.py Threshold_Demo<br>@end_toggle</p>
<p>As you can see, the function @ref cv::threshold is invoked. We give \f$5\f$ parameters in C++ code:</p>
<ul>
<li><em>src_gray</em>: Our input image</li>
<li><em>dst</em>: Destination (output) image</li>
<li><em>threshold_value</em>: The \f$thresh\f$ value with respect to which the thresholding operation<br>is made</li>
<li><em>max_BINARY_value</em>: The value used with the Binary thresholding operations (to set the<br>chosen pixels)</li>
<li><em>threshold_type</em>: One of the \f$5\f$ thresholding operations. They are listed in the<br>comment section of the function above.</li>
</ul>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>-#  After compiling this program, run it giving a path to an image as argument. For instance, for an<br>    input image as:</p>
<pre><code>![](images/Threshold_Tutorial_Original_Image.jpg)
</code></pre>
<p>-#  First, we try to threshold our image with a <em>binary threshold inverted</em>. We expect that the<br>    pixels brighter than the \f$thresh\f$ will turn dark, which is what actually happens, as we can see<br>    in the snapshot below (notice from the original image, that the doggie’s tongue and eyes are<br>    particularly bright in comparison with the image, this is reflected in the output image).</p>
<pre><code>![](images/Threshold_Tutorial_Result_Binary_Inverted.jpg)
</code></pre>
<p>-#  Now we try with the <em>threshold to zero</em>. With this, we expect that the darkest pixels (below the<br>    threshold) will become completely black, whereas the pixels with value greater than the<br>    threshold will keep its original value. This is verified by the following snapshot of the output<br>    image:</p>
<pre><code>![](images/Threshold_Tutorial_Result_Zero.jpg)
</code></pre>
