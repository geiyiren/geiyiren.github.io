<h1 id="Object-Detection-using-CNNs-tutorial-dnn-objdetect"><a href="#Object-Detection-using-CNNs-tutorial-dnn-objdetect" class="headerlink" title="Object Detection using CNNs {#tutorial_dnn_objdetect}"></a>Object Detection using CNNs {#tutorial_dnn_objdetect}</h1><h1 id="Building"><a href="#Building" class="headerlink" title="Building"></a>Building</h1><p>Build samples of “dnn_objectect” module. Refer to OpenCV build tutorials for details.<br>Enable <code>BUILD_EXAMPLES=ON</code> CMake option and build these targets (Linux):</p>
<ul>
<li>example_dnn_objdetect_image_classification</li>
<li>example_dnn_objdetect_obj_detect</li>
</ul>
<p>Download the weights file and model definition file from <code>opencv_extra/dnn_objdetect</code></p>
<h1 id="Object-Detection"><a href="#Object-Detection" class="headerlink" title="Object Detection"></a>Object Detection</h1><pre><code class="bash">example_dnn_objdetect_obj_detect  &lt;model-definition-file&gt;  &lt;model-weights-file&gt;  &lt;test-image&gt;
</code></pre>
<p>All the following examples were run on a laptop with <code>Intel(R) Core(TM)2 i3-4005U CPU @ 1.70GHz</code> (without GPU).</p>
<p>The model is incredibly fast taking just <code>0.172091</code> seconds on an average to predict multiple bounding boxes.</p>
<pre><code class="bash">&lt;bin_path&gt;/example_dnn_objdetect_obj_detect  SqueezeDet_deploy.prototxt  SqueezeDet.caffemodel  tutorials/images/aeroplane.jpg

Total objects detected: 1 in 0.168792 seconds
------
Class: aeroplane
Probability: 0.845181
Co-ordinates: 41 116 415 254
------
</code></pre>
<p><img src="/images/aero_det.jpg" alt="Train_Dets"></p>
<pre><code class="bash">&lt;bin_path&gt;/example_dnn_objdetect_obj_detect  SqueezeDet_deploy.prototxt  SqueezeDet.caffemodel  tutorials/images/bus.jpg

Total objects detected: 1 in 0.201276 seconds
------
Class: bus
Probability: 0.701829
Co-ordinates: 0 32 415 244
------
</code></pre>
<p><img src="/images/bus_det.jpg" alt="Train_Dets"></p>
<pre><code class="bash">&lt;bin_path&gt;/example_dnn_objdetect_obj_detect  SqueezeDet_deploy.prototxt  SqueezeDet.caffemodel  tutorials/images/cat.jpg

Total objects detected: 1 in 0.190335 seconds
------
Class: cat
Probability: 0.703465
Co-ordinates: 34 0 381 282
------
</code></pre>
<p><img src="/images/cat_det.jpg" alt="Train_Dets"></p>
<pre><code class="bash">&lt;bin_path&gt;/example_dnn_objdetect_obj_detect  SqueezeDet_deploy.prototxt  SqueezeDet.caffemodel  tutorials/images/persons_mutli.jpg

Total objects detected: 2 in 0.169152 seconds
------
Class: person
Probability: 0.737349
Co-ordinates: 160 67 313 363
------
Class: person
Probability: 0.720328
Co-ordinates: 187 198 222 323
------
</code></pre>
<p><img src="/images/person_multi_det.jpg" alt="Train_Dets"></p>
<p>Go ahead and run the model with other images !</p>
<h2 id="Changing-threshold"><a href="#Changing-threshold" class="headerlink" title="Changing threshold"></a>Changing threshold</h2><p>By default this model thresholds the detections at confidence of <code>0.53</code>. While filtering there are number of bounding boxes which are predicted, you can manually control what gets thresholded by passing the value of optional arguement <code>threshold</code> like:</p>
<pre><code class="bash">&lt;bin_path&gt;/example_dnn_objdetect_obj_detect  &lt;model-definition-file&gt;  &lt;model-weights-file&gt;  &lt;test-image&gt; &lt;threshold&gt;
</code></pre>
<p>Changing the threshold to say <code>0.0</code>, produces the following:</p>
<p><img src="/images/aero_thresh_det.jpg" alt="Train_Dets"></p>
<p>That doesn’t seem to be that helpful !</p>
<h1 id="Image-Classification"><a href="#Image-Classification" class="headerlink" title="Image Classification"></a>Image Classification</h1><pre><code class="bash">example_dnn_objdetect_image_classification  &lt;model-definition-file&gt;  &lt;model-weights-file&gt;  &lt;test-image&gt;
</code></pre>
<p>The size of the model being <strong>4.9MB</strong>, just takes a time of <strong>0.136401</strong> seconds to classify the image.</p>
<p>Running the model on examples produces the following results:</p>
<pre><code class="bash">&lt;bin_path&gt;/example_dnn_objdetect_image_classification  SqueezeNet_deploy.prototxt  SqueezeNet.caffemodel  tutorials/images/aeroplane.jpg
Best class Index: 404
Time taken: 0.137722
Probability: 77.1757
</code></pre>
<p>Looking at <a href="https://raw.githubusercontent.com/opencv/opencv/3.4.0/samples/data/dnn/synset_words.txt">synset_words.txt</a>, the predicted class belongs to <code>airliner</code></p>
<pre><code class="bash">&lt;bin_path&gt;/example_dnn_objdetect_image_classification  SqueezeNet_deploy.prototxt  SqueezeNet.caffemodel  tutorials/images/cat.jpg
Best class Index: 285
Time taken: 0.136401
Probability: 40.7111
</code></pre>
<p>This belongs to the class: <code>Egyptian cat</code></p>
<pre><code class="bash">&lt;bin_path&gt;/example_dnn_objdetect_image_classification  SqueezeNet_deploy.prototxt  SqueezeNet.caffemodel  tutorials/images/space_shuttle.jpg
Best class Index: 812
Time taken: 0.137792
Probability: 15.8467
</code></pre>
<p>This belongs to the class: <code>space shuttle</code></p>
