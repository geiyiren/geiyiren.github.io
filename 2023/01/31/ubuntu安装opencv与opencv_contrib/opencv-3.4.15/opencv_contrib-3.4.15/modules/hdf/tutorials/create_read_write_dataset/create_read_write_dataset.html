<h1 id="Creating-Writing-and-Reading-Datasets-tutorial-hdf-create-read-write-datasets"><a href="#Creating-Writing-and-Reading-Datasets-tutorial-hdf-create-read-write-datasets" class="headerlink" title="Creating, Writing and Reading Datasets {#tutorial_hdf_create_read_write_datasets}"></a>Creating, Writing and Reading Datasets {#tutorial_hdf_create_read_write_datasets}</h1><h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>This tutorial shows you:</p>
<ul>
<li>How to create a dataset?</li>
<li>How to write a <code>cv::Mat</code> to a dataset?</li>
<li>How to read a <code>cv::Mat</code> from a dataset?</li>
</ul>
<p>@note Currently, it supports only reading and writing cv::Mat and the matrix should be continuous<br>in memory. Supports for other data types have not been implemented yet.</p>
<h2 id="Source-Code"><a href="#Source-Code" class="headerlink" title="Source Code"></a>Source Code</h2><p>The following code demonstrates writing a single channel<br>matrix and a two-channel matrix to datasets and then reading them<br>back.</p>
<p>You can download the code from <a href="https://github.com/opencv/opencv_contrib/tree/master/modules/hdf/samples/create_read_write_datasets.cpp">here</a> or find it in the file<br><code>modules/hdf/samples/create_read_write_datasets.cpp</code> of the opencv_contrib source code library.</p>
<p>@snippet samples&#x2F;create_read_write_datasets.cpp tutorial</p>
<h2 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a>Explanation</h2><p>The first step for creating a dataset is to open the file</p>
<p>@snippet samples&#x2F;create_read_write_datasets.cpp tutorial_open_file</p>
<p>For the function <code>write_root_group_single_channel()</code>, since<br>the dataset name is <code>/single</code>, which is inside the root group, we can use</p>
<p>@snippet samples&#x2F;create_read_write_datasets.cpp tutorial_write_root_single_channel</p>
<p>to write the data directly to the dataset without the need of creating<br>it beforehand. Because it is created inside cv::hdf::HDF5::dswrite()<br>automatically.</p>
<p>@warning This applies only to datasets that reside inside the root group.</p>
<p>Of course, we can create the dataset by ourselves:</p>
<p>@snippet samples&#x2F;create_read_write_datasets.cpp tutorial_create_dataset</p>
<p>To read data from a dataset, we use</p>
<p>@snippet samples&#x2F;create_read_write_datasets.cpp tutorial_read_dataset</p>
<p>by specifying the name of the dataset.</p>
<p>We can check that the data read out is exactly the data written before by using</p>
<p>@snippet samples&#x2F;create_read_write_datasets.cpp tutorial_check_result</p>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>Figure 1 shows the result visualized using the tool HDFView for the file<br><code>root_group_single_channel</code>. The results<br>of matrices for datasets that are not the direct children of the root group<br>are given in Figure 2 and Figure 3, respectively.</p>
<p><img src="/pics/root_group_single_channel.png" alt="Figure 1: Result for writing a single channel matrix to a dataset inside the root group"></p>
<p><img src="/pics/single_channel.png" alt="Figure 2: Result for writing a single channel matrix to a dataset not in the root group"></p>
<p><img src="/pics/two_channels.png" alt="Figure 3: Result for writing a two-channel matrix to a dataset not in the root group"></p>
